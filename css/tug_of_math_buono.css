:root{
  --bg1:#0b1220;
  --stroke:#ffffff22;
  --txt:#eaf0ff;
  --muted:#b9c6ffcc;

  --blue:#2f7bff;
  --red:#ff3b3b;
  --good:#27d17c;
  --bad:#ff6b6b;

  --shadow: 0 12px 30px #00000055;
  --radius: 18px;
}

*{ box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  color:var(--txt);
  /*background: radial-gradient(1200px 700px at 50% 10%, #1b2a55 0%, var(--bg1) 55%, #060b16 100%);*/
  background-color: #fff;
}

.topbar{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  padding:12px 14px;
  border-bottom:1px solid var(--stroke);
  /*background: linear-gradient(180deg, #0f1a33cc, #0b1220cc);*/
  background-color: #fff;
  backdrop-filter: blur(8px);
  position: sticky;
  top:0;
  z-index:10;
}

.brand{ font-weight:900; letter-spacing:.8px; font-size:14px; opacity:.95; }

.controls{
  display:flex;
  align-items:center;
  gap:10px;
  flex-wrap:wrap;
  justify-content:flex-end;
}

.ctrl{
  display:flex;
  align-items:center;
  gap:8px;
  font-size:12px;
  color:var(--muted);
  padding:6px 10px;
  border:1px solid var(--stroke);
  border-radius:999px;
  background:#0c142a88;
}

select, input[type="checkbox"]{ accent-color: var(--blue); }

select{
  background:#0b1328;
  color:var(--txt);
  border:1px solid var(--stroke);
  border-radius:10px;
  padding:6px 8px;
  outline:none;
}

.btn{
  border:1px solid var(--stroke);
  background:#0c142a;
  color:var(--txt);
  padding:8px 12px;
  border-radius:999px;
  cursor:pointer;
  box-shadow: var(--shadow);
}
.btn:hover{ transform: translateY(-1px); }

.layout{
  display:grid;
  grid-template-columns: 1fr minmax(320px, 520px) 1fr;
  gap:14px;

  /* ✅ larghezza più stretta */
  max-width: 1400px;     /* puoi mettere 1300 o 1200 se vuoi ancora più stretto */
  margin: 0 auto;        /* centra tutto */
  padding: 20px 24px;    /* un po’ più aria ai lati */
}

.topbar{
  max-width: 1400px;
  margin: 0 auto;
  padding: 14px 24px;
}
.panel{
  background: linear-gradient(180deg, #101b33cc, #0b1328cc);
  border:1px solid var(--stroke);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding:12px;
  display:flex;
  flex-direction:column;
  gap:10px;
  min-height: 520px;
  position: relative;
  overflow: hidden;
}

/* ✅ Effetti flash/glow sul pannello */
.panel::after{
  content:"";
  position:absolute;
  inset:-2px;
  opacity:0;
  pointer-events:none;
  transition: opacity .2s ease;
}
.panel.hitBad::after{
  opacity:1;
  background: radial-gradient(600px 220px at 50% 30%, rgba(255,59,59,.55), rgba(255,59,59,0) 70%);
  animation: panelShake .28s ease;
}
.panel.hitGood::after{
  opacity:1;
  background: radial-gradient(600px 220px at 50% 30%, rgba(39,209,124,.45), rgba(39,209,124,0) 70%);
}
@keyframes panelShake{
  0%{ transform: translateX(0); }
  25%{ transform: translateX(-6px); }
  50%{ transform: translateX(6px); }
  75%{ transform: translateX(-4px); }
  100%{ transform: translateX(0); }
}

.teamHead{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:10px 12px;
  border-radius: 14px;
  border:1px solid #ffffff22;
  font-weight:800;
}
.teamHead.blue{ background: linear-gradient(90deg, #1d4fd6, #2f7bff); }
.teamHead.red{ background: linear-gradient(90deg, #b31414, #ff3b3b); }

.timer{
  font-size:12px;
  background:#00000033;
  padding:6px 10px;
  border-radius:999px;
  border:1px solid #ffffff22;
}

/* ENERGIA */
.energyBox{
  padding:10px 12px;
  border-radius: 14px;
  border:1px solid var(--stroke);
  background:#0b1328aa;
}
.energyTop{ display:flex; align-items:center; justify-content:space-between; margin-bottom:8px; }
.energyLabel{ font-size:12px; color:var(--muted); font-weight:800; letter-spacing:.2px; }
.energyPct{
  font-size:12px;
  color:var(--txt);
  font-weight:900;
  padding:4px 8px;
  border-radius:999px;
  border:1px solid #ffffff22;
  background:#00000033;
}
.energyBar{
  height:14px;
  border-radius:999px;
  border:1px solid #ffffff22;
  background:#071026;
  overflow:hidden;
  box-shadow: inset 0 2px 10px #00000055;
}
.energyFill{
  height:100%;
  width:50%;
  border-radius:999px;
  transition: width .25s ease;
}
.energyBar.blue .energyFill{ background: linear-gradient(90deg, #2f7bff, #7fb2ff); }
.energyBar.red  .energyFill{ background: linear-gradient(90deg, #ff3b3b, #ff9a9a); }

.opBox{
  padding:10px 12px;
  border-radius: 14px;
  border:1px solid var(--stroke);
  background:#0b1328aa;
}
.opLabel{ font-size:12px; color:var(--muted); margin-bottom:6px; }
.opText{ font-size:26px; font-weight:900; letter-spacing:.4px; }

.answerRow{ display:flex; gap:10px; align-items:center; }
.answer{
  flex:1;
  font-size:24px;
  font-weight:900;
  padding:10px 12px;
  border-radius:14px;
  border:1px solid var(--stroke);
  background:#071026;
  color:var(--txt);
  text-align:center;
}
.miniBtn{
  padding:10px 14px;
  border-radius:14px;
  border:1px solid var(--stroke);
  background:#0c142a;
  color:var(--txt);
  cursor:pointer;
  font-weight:900;
}

.keypad{
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap:10px;
  margin-top:4px;
}
.key{
  user-select:none;
  border-radius:14px;
  border:1px solid var(--stroke);
  background:#0c142a;
  padding:14px 0;
  font-size:20px;
  font-weight:900;
  text-align:center;
  cursor:pointer;
  box-shadow: 0 10px 20px #00000044;
}
.key:active{ transform: translateY(1px) scale(.99); }
.key.keyC{ background:#b31414; }
.key.key0{ background:#0b1328; }
.key.keyOK{ background:#1d8b5a; grid-column: 2 / span 2; }

.status{ min-height:22px; font-weight:800; letter-spacing:.2px; }
.status.good{ color:var(--good); }
.status.bad{ color:var(--bad); }

.center .arena{
  height:100%;
  background: linear-gradient(180deg, #101b33cc, #0b1328cc);
  border:1px solid var(--stroke);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding:12px;
  display:flex;
  flex-direction:column;
  justify-content:center;
  gap:14px;
  position:relative;
  min-height: 520px;
}

.rope{
  position:relative;
  height:140px;
  border-radius:18px;
  border:1px solid var(--stroke);
  background: radial-gradient(700px 200px at 50% 50%, #162a57 0%, #0a1228 70%, #070d1d 100%);
  overflow:hidden;
}
.midline{
  position:absolute;
  top:0; bottom:0;
  left:50%;
  width:2px;
  background:#ffffff22;
}
.marker{
  position:absolute;
  top:50%;
  left:50%;
  width:70px;
  height:26px;
  transform: translate(-50%, -50%);
  border-radius:999px;
  background: linear-gradient(90deg, #ffcc00, #ff8a00);
  border:1px solid #ffffff55;
  box-shadow: 0 10px 18px #00000066;
  transition: transform .28s ease;
}
.flag{
  position:absolute;
  top:14px;
  width:44px;
  height:44px;
  border-radius:12px;
  border:1px solid #ffffff33;
  background:#0c142a;
  box-shadow: 0 12px 22px #00000055;
}
.flagL{ left:14px; background: linear-gradient(180deg, #1d4fd6, #2f7bff); }
.flagR{ right:14px; background: linear-gradient(180deg, #b31414, #ff3b3b); }

.scoreRow{
  display:flex;
  justify-content:space-between;
  gap:10px;
  padding:10px 12px;
  border-radius:14px;
  border:1px solid var(--stroke);
  background:#0b1328aa;
}
.score{ font-weight:900; letter-spacing:.2px; }
.score.blue{ color:#9fc0ff; }
.score.red{ color:#ffb1b1; }

.announce{ text-align:center; font-size:18px; font-weight:900; min-height:24px; opacity:.95; }

/* ✅ Overlay START */
.startOverlay{
  position:fixed;
  inset:0;
  background: radial-gradient(900px 500px at 50% 30%, rgba(47,123,255,.22), rgba(0,0,0,.72) 70%);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:999;
}
.startOverlay.hide{ display:none; }

.startCard{
  width:min(520px, calc(100vw - 30px));
  border-radius: 22px;
  border:1px solid #ffffff2a;
  background: linear-gradient(180deg, #111c35ee, #0b1328ee);
  box-shadow: 0 20px 60px #00000077;
  padding:18px;
  text-align:center;
}
.startTitle{
  font-size:28px;
  font-weight:1000;
  letter-spacing:.4px;
}
.startText{
  margin-top:8px;
  color:var(--muted);
  font-weight:700;
  line-height:1.35;
}
.startBtn{
  margin-top:14px;
  width: 100%;
  padding:14px 16px;
  border-radius:16px;
  border:1px solid #ffffff2a;
  background: linear-gradient(90deg, #1d4fd6, #2f7bff);
  color:#fff;
  font-weight:1000;
  font-size:18px;
  cursor:pointer;
  box-shadow: 0 16px 40px #00000066;
}
.startBtn:active{ transform: translateY(1px); }

@media (max-width: 980px){
  .layout{ grid-template-columns: 1fr; }
  .center .arena, .panel{ min-height: unset; }
}

/* --- aggiunte overlay impostazioni --- */
.startPills{
  margin-top:12px;
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  justify-content:center;
}
.pill{
  font-size:12px;
  font-weight:900;
  color: var(--txt);
  border:1px solid #ffffff2a;
  background:#00000033;
  padding:8px 10px;
  border-radius:999px;
}
.ghostBtn{
  margin-top:10px;
  width:100%;
  padding:10px 12px;
  border-radius:16px;
  border:1px solid #ffffff2a;
  background:#0c142a;
  color: var(--muted);
  font-weight:900;
  cursor:pointer;
}
.ghostBtn:active{ transform: translateY(1px); }


/* Banner setup */
.setupBanner{
  margin: 10px 14px 0 14px;
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid #ffffff22;
  background: #0c142a88;
  color: #b9c6ffcc;
  font-weight: 800;
  text-align:center;
}
.setupBanner.hide{ display:none; }

/* Bottone GIOCA */
.btnPlay{
  background: linear-gradient(90deg, #1d4fd6, #2f7bff);
  border-color: #ffffff2a;
}


/* --- WIN EFFECT centro --- */
.winFX{
  position:absolute;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  z-index:50;
  background: radial-gradient(700px 380px at 50% 45%, rgba(255,255,255,.10), rgba(0,0,0,.65) 70%);
  backdrop-filter: blur(2px);
}

.winFX.show{ display:flex; }

.winFXCard{
  border-radius: 22px;
  border: 1px solid #ffffff2a;
  background: linear-gradient(180deg, #111c35ee, #0b1328ee);
  box-shadow: 0 22px 70px #00000088;
  padding: 18px 18px 16px;
  text-align:center;
  min-width: min(420px, calc(100vw - 80px));
  transform: scale(.92);
  opacity: 0;
  animation: winPop .55s ease forwards;
}

@keyframes winPop{
  0%{ transform: scale(.86); opacity:0; }
  60%{ transform: scale(1.06); opacity:1; }
  100%{ transform: scale(1.00); opacity:1; }
}

.winFXTitle{
  font-weight:1000;
  letter-spacing:.6px;
  font-size:34px;
  margin-bottom:6px;
}
.winFXSub{
  font-weight:900;
  color: #b9c6ffcc;
  font-size:14px;
}

/* confetti (12 pezzi) */
.confetti{
  position:absolute;
  inset:0;
  overflow:hidden;
  pointer-events:none;
}
.confetti span{
  position:absolute;
  top:-12px;
  width:10px;
  height:16px;
  border-radius:4px;
  opacity:.95;
  animation: confFall 1.6s ease-in forwards;
  box-shadow: 0 10px 18px #00000044;
}

/* colori alternati senza usare JS */
.confetti span:nth-child(3n+1){ background:#ffcc00; }
.confetti span:nth-child(3n+2){ background:#2f7bff; }
.confetti span:nth-child(3n){ background:#ff3b3b; }

@keyframes confFall{
  0%{ transform: translateY(0) rotate(0deg); opacity:0; }
  10%{ opacity:1; }
  100%{ transform: translateY(520px) rotate(540deg); opacity:0; }
}

/* Pulsanti WIN */
.winFXButtons{
  margin-top:16px;
  display:flex;
  gap:10px;
  justify-content:center;
}

.winBtnPrimary{
  padding:10px 16px;
  border-radius:14px;
  border:1px solid #ffffff2a;
  background: linear-gradient(90deg, #1d4fd6, #2f7bff);
  color:#fff;
  font-weight:1000;
  cursor:pointer;
  box-shadow: 0 10px 25px #00000066;
}

.winBtnGhost{
  padding:10px 16px;
  border-radius:14px;
  border:1px solid #ffffff2a;
  background:#0c142a;
  color:#b9c6ffcc;
  font-weight:900;
  cursor:pointer;
}

.winBtnPrimary:active,
.winBtnGhost:active{
  transform: translateY(1px);
}


/* ===== WOW ROPE + MARKER ===== */
.rope{
  position:relative;
  overflow:hidden;
}

/* texture/luce sulla corda */
.rope::before{
  content:"";
  position:absolute;
  inset:0;
  background:
    radial-gradient(900px 220px at 50% 40%, rgba(255,255,255,.10), rgba(0,0,0,0) 65%),
    repeating-linear-gradient(90deg,
      rgba(255,255,255,.06) 0 10px,
      rgba(0,0,0,.08) 10px 20px
    );
  mix-blend-mode: screen;
  opacity:.55;
  pointer-events:none;
}

/* scia del movimento */
.ropeTrail{
  position:absolute;
  top:50%;
  left:50%;
  height:18px;
  width:0px;               /* verrà gestita da JS (opzionale) */
  transform: translate(-50%,-50%);
  border-radius:999px;
  background: linear-gradient(90deg, rgba(255,204,0,0), rgba(255,204,0,.55), rgba(255,138,0,.0));
  filter: blur(2px);
  opacity:.9;
  pointer-events:none;
}

/* segnalino: nodo 3D */
.marker{
  width:84px;
  height:30px;
  border-radius:999px;
  background:
    radial-gradient(18px 18px at 30% 35%, rgba(255,255,255,.55), rgba(255,255,255,0) 60%),
    linear-gradient(180deg, #ffd34a, #ff8a00);
  border:1px solid rgba(255,255,255,.55);
  box-shadow:
    0 14px 28px rgba(0,0,0,.65),
    inset 0 2px 8px rgba(255,255,255,.22);
  transition: transform .32s cubic-bezier(.2,.9,.2,1);
}

/* anello/nodo interno */
.marker::before{
  content:"";
  position:absolute;
  inset:5px 16px;
  border-radius:999px;
  background:
    radial-gradient(22px 10px at 50% 30%, rgba(0,0,0,.25), rgba(0,0,0,0) 60%),
    repeating-linear-gradient(45deg,
      rgba(255,255,255,.14) 0 6px,
      rgba(0,0,0,.08) 6px 12px
    );
  opacity:.85;
}

/* “pulse” quando si muove */
.marker.pulse{
  animation: markerPulse .35s ease;
}
@keyframes markerPulse{
  0%{ filter: brightness(1); }
  50%{ filter: brightness(1.35) saturate(1.2); }
  100%{ filter: brightness(1); }
}

/* scintille */
.spark{
  position:absolute;
  top:50%;
  width:10px; height:10px;
  border-radius:50%;
  transform: translate(-50%,-50%);
  background: radial-gradient(circle, rgba(255,255,255,.95), rgba(255,204,0,.6), rgba(255,138,0,0));
  filter: blur(.2px);
  pointer-events:none;
  opacity:0;
}
.spark.go{
  animation: sparkPop .45s ease forwards;
}
@keyframes sparkPop{
  0%{ opacity:0; transform: translate(-50%,-50%) scale(.6); }
  20%{ opacity:1; }
  100%{ opacity:0; transform: translate(-50%,-50%) translateY(-34px) scale(1.4); }
}
.rope.shakeL{ animation: ropeShakeL .25s ease; }
.rope.shakeR{ animation: ropeShakeR .25s ease; }
@keyframes ropeShakeL{
  0%{ transform: translateX(0); }
  50%{ transform: translateX(-6px); }
  100%{ transform: translateX(0); }
}
@keyframes ropeShakeR{
  0%{ transform: translateX(0); }
  50%{ transform: translateX(6px); }
  100%{ transform: translateX(0); }
}

.rope.dangerL{ box-shadow: inset 80px 0 120px rgba(47,123,255,.18); }
.rope.dangerR{ box-shadow: inset -80px 0 120px rgba(255,59,59,.18); }