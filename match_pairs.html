<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Abbinamenti</title>

  <style>
/* ===== Base ===== */
body{ margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; background:#f4f6f8; color:#0f172a; overflow-x:hidden; }
.wrap{ max-width:1100px; margin:0 auto; padding:18px 14px 60px; transform-origin: top center; }
.top{ display:flex; align-items:flex-end; gap:12px; flex-wrap:wrap; }
.h1{ font-size:22px; font-weight:800; margin:10px 0 0; }
.muted{ color:#6b7280; font-size:14px; margin:4px 0 0; }

.bar{ margin-left:auto; display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:flex-end; }
.btn{
  border:1px solid rgba(15,23,42,.12);
  background:#fff;
  border-radius:14px;
  padding:10px 12px;
  font-weight:700;
  cursor:pointer;
}
.btn:hover{ background: rgba(15,23,42,.04); }
.btn.on{ background:#0f172a; color:#fff; border-color:#0f172a; }

.zoomBox{ display:flex; align-items:center; gap:6px; }
.pairSizeBox{ display:flex; gap:6px; align-items:center; }
.sizeBtn{ min-width:42px; padding:8px 10px; }
.sizeBtn.active{ background:#0f172a; color:#fff; border-color:#0f172a; }

/* ===== Layout ===== */
.board{
  margin-top:16px;
  display:grid;
  grid-template-columns: 0.9fr 1.3fr;
  gap:14px;
  align-items:start;
}
.panel{
  background:#fff;
  border:1px solid rgba(15,23,42,.08);
  border-radius:18px;
  box-shadow: 0 10px 22px rgba(15,23,42,.05);
  padding:1px;
}
/* =====================================================
   Rimuove bordo bianco laterale solo su ABBINA
   ===================================================== */
.board .panel:nth-child(2){
  padding-left: 6px;
  padding-right: 6px;
}
.board .panel:nth-child(2){
  background: linear-gradient(180deg,#f0f9ff 0%, #e0f2fe 100%);
}
.panelTitle{
  font-weight:800;
  margin:2px 0 12px;
  font-size:14px;
  color:#6b7280;
  letter-spacing:.2px;
}

/* ===== Pieces (sinistra) ===== */
#leftCol{
  display:grid;
  grid-template-columns: repeat(3, minmax(0,1fr));
  gap:10px;
}
.piece{
  border:1px solid rgba(15,23,42,.10);
  background:#fff;
  border-radius:10px;
  padding:6px;
  touch-action:none;
  user-select:none;
  aspect-ratio: 1 / 1;
  box-sizing:border-box;
}
.piece.dragging{ box-shadow: 0 20px 50px rgba(15,23,42,.18); cursor: grabbing; }
.piece{ cursor: grab; }

.pieceContent{
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
}
.pieceContent img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
  -webkit-user-drag:none;
  user-drag:none;
  -webkit-touch-callout:none;
  pointer-events:none;
  user-select:none;
}
.pieceText{
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  padding:6px;
  font-weight:800;
  font-size: clamp(10px, 2.6vw, 16px);
  line-height:1.15;
}

/* ===== Right (abbina) â€“ DESKTOP/LIM ===== */
#rightCol{
  display:grid;
  grid-template-columns: repeat(4, minmax(0,1fr));
  gap:8px;
  background:#fff;
}
#rightCol[data-pairs="12"]{
  grid-template-columns: repeat(6, minmax(0,1fr));
}
.row{ display: contents; }

/* Cells */
.drop, .fixed{
  aspect-ratio: 1 / 1;
  width:100%;
  border-radius:10px;
  padding:0;
  overflow:hidden;
  box-sizing:border-box;
}
.drop{
  border:2px dashed rgba(14,165,233,.55);
  background: rgba(14,165,233,.08);
  position:relative;
}
.fixed{
  border:2px solid rgba(15,23,42,.18);
  background: rgba(14,165,233,.08);
  position:relative;
  display:flex;
  align-items:center;
  justify-content:center;
}

.dropHint{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  color:#94a3b8;
  font-weight:800;
  font-size:13px;
  pointer-events:none;
}

.drop.highlight{ background: rgba(15,23,42,.03); }
.drop.over{ border-color: rgba(15,23,42,.45); }
.drop.wrong{ border-color: rgba(220,38,38,.55); background: rgba(220,38,38,.05); }

.drop.filled{
  border-style: solid;
  border-color: rgba(15,23,42,.18);
}

/* ===== Pair colors (optional border accents) ===== */
.pairA.drop{ border-color: rgba(59,130,246,.55); }
.pairB.drop{ border-color: rgba(168,85,247,.55); }
.pairC.drop{ border-color: rgba(16,185,129,.55); }
.pairA.fixed{ border-color: rgba(59,130,246,.45); }
.pairB.fixed{ border-color: rgba(168,85,247,.45); }
.pairC.fixed{ border-color: rgba(16,185,129,.45); }

/* =====================================================
   TAPPO UNICO SOTTO LE COPPIE (visibile sempre)
   ===================================================== */

#rightCol .pairA,
#rightCol .pairB,
#rightCol .pairC{
  border-radius:14px;
  padding:4px 0;   /* âœ… niente spazio laterale */
}

#rightCol .pairA{ background: rgba(59,130,246,.10); }
#rightCol .pairB{ background: rgba(168,85,247,.10); }
#rightCol .pairC{ background: rgba(16,185,129,.10); }



/* ===== Done / WOW effects (kept) ===== */
body.dragMode{ overscroll-behavior: none; }
body.done .drop{ opacity:.98; }

@keyframes winPop { 0%{transform:scale(1)} 35%{transform:scale(1.02)} 100%{transform:scale(1)} }
@keyframes glow { 0%{box-shadow:0 10px 22px rgba(15,23,42,.05)} 50%{box-shadow:0 26px 70px rgba(15,23,42,.18)} 100%{box-shadow:0 10px 22px rgba(15,23,42,.05)} }
body.done .panel{ animation: winPop .45s ease; }
body.done .drop.filled, body.done .fixed{ animation: glow .8s ease; }

@keyframes pulse { 0%{transform:scale(1)} 45%{transform:scale(1.03)} 100%{transform:scale(1)} }
.drop.pulse{ animation:pulse .45s ease; }

@keyframes wowGreen{
  0%{ transform:scale(1); box-shadow:0 10px 22px rgba(15,23,42,.06), 0 0 0 rgba(34,197,94,0); }
  45%{ transform:scale(1.06); box-shadow:0 30px 80px rgba(34,197,94,.40), 0 0 45px rgba(34,197,94,.65), 0 0 90px rgba(34,197,94,.35); }
  100%{ transform:scale(1); box-shadow:0 10px 22px rgba(15,23,42,.06); }
}
.wowOn{ animation: wowGreen .7s ease; border:2px solid rgba(34,197,94,.85) !important; }
.successFinal{
  background: linear-gradient(180deg,#ffffff 0%, #f0fdf4 100%) !important;
  border:2px solid rgba(34,197,94,.55) !important;
  box-shadow: 0 15px 35px rgba(34,197,94,.18);
}
.checkMark{
  position:absolute; top:10px; right:10px;
  width:34px; height:34px; border-radius:999px;
  display:flex; align-items:center; justify-content:center;
  background: rgba(34,197,94,.18);
  border:2px solid rgba(34,197,94,.70);
  box-shadow: 0 10px 24px rgba(34,197,94,.22), 0 0 22px rgba(34,197,94,.25);
  color:#16a34a; font-weight:900; font-size:18px; line-height:1;
  opacity:0; transform: scale(.6);
  pointer-events:none;
}
@keyframes checkPop{ 0%{transform:scale(.6);opacity:0} 55%{transform:scale(1.15);opacity:1} 100%{transform:scale(1);opacity:1} }
.checkMark.show{ animation: checkPop .35s ease forwards; }

/* ===== Responsive ===== */
@media (max-width: 900px){
  .board{ grid-template-columns: 1fr; }

  /* left: piÃ¹ compatto */
  #leftCol{ grid-template-columns: repeat(3, minmax(0,1fr)); gap:8px; }

  /* âœ… right: niente griglia globale (evita â€œsaltiâ€ quando una coppia cambia) */
  #rightCol{
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    background:#fff;
  }

  /* âœ… ogni coppia Ã¨ un mini-grid indipendente */
  .row{
    display:grid;
    grid-template-columns: 0.58fr 1.42fr;
    gap:8px;

    box-sizing: border-box;              /* âœ… padding incluso nella larghezza */
    flex: 0 0 calc(50% - 10px);          /* âœ… 2 coppie per riga anche col tappeto */
    width: auto;                         /* âœ… evita doppioni/overflow */
  }

  /* card sempre quadrate */
  .row > .drop, .row > .fixed{
    aspect-ratio: 1/1;
    width:100%;
    padding:0;
    border-radius:10px;
    overflow:hidden;
  }

  /* âœ… DOPO MATCH: diventano UGUALI (1fr/1fr) */
  .row.matched{
  grid-template-columns: 1fr 1fr;
  gap: 4px;                 /* âœ… meno spazio tra le 2 card matchate */
}

  /* âœ… DOPO MATCH: stesso stile */
  .row.matched > .drop,
  .row.matched > .fixed{
    border:2px solid rgba(15,23,42,.20) !important;
    background: transparent !important;
  }
  .row.matched > .drop{ border-style: solid !important; }
}

@media (min-width: 420px) and (max-width: 520px){
  #leftCol{ grid-template-columns: repeat(4, minmax(0,1fr)); }
}

/* barra su smartphone */
@media (max-width: 520px){
  .bar{ width:100%; margin-left:0; justify-content:flex-start; gap:8px; }
  #status{ width:100%; }
  .bar .btn{
    flex: 1 1 calc(50% - 8px);
    max-width: calc(50% - 8px);
    text-align:center;
    padding:8px 10px;
    font-size:13px;
    border-radius:12px;
  }
  .zoomBox{ flex:1 1 100%; justify-content:flex-start; }
  #zoomLabel{ min-width:72px; text-align:center; display:inline-block; }
}
</style>
</head>

<body>
  <!-- Menu unico -->
  <script src="js/nav.js"></script>
  <script src="js/menu.js"></script>

  <main class="wrap">
    <div class="top">
      <div>
        <div class="h1">Abbinamenti</div>
        <div class="muted">Trascina gli elementi di sinistra nel riquadro giusto a destra.</div>
      </div>
      <div class="bar">
        <div id="status" class="muted">â€¦</div>
        <button id="btnShuffle" class="btn" type="button">ðŸ”€ Mescola</button>
        <button id="btnReset" class="btn" type="button" style="display: none;">â†º Reset</button>

        <button id="btnRepick" class="btn" type="button">ðŸŽ´ Cambia Card</button>

        <div id="pairSizeBox" class="pairSizeBox">
  <button class="btn sizeBtn" data-size="4">4</button>
  <button class="btn sizeBtn" data-size="6">6</button>
  <button class="btn sizeBtn" data-size="8">8</button>
  <button class="btn sizeBtn" data-size="12">12</button>
        </div>
        <button id="btnBackSelect" class="btn" type="button">â¬… Cambia Argomento</button>

        <div class="zoomBox">
  <button class="btn" id="zAuto" type="button">AUTO</button>
  <button class="btn" id="zMinus" type="button">âž–</button>
  <span id="zoomLabel" class="muted">AUTO</span>
  <button class="btn" id="zPlus" type="button">âž•</button>
</div>


      </div>
    </div>

    <section class="board">
      <div class="panel">
        <div class="panelTitle">ELEMENTI DA SPOSTARE</div>
        <div id="leftCol"></div>
      </div>

      <div class="panel">
        <div class="panelTitle">ABBINA</div>
        <div id="rightCol"></div>
      </div>
    </section>
  </main>


  <!-- AUDIO -->
<audio id="sfxAttach" src="audio/effetto_sonoro_din.mp3" preload="auto"></audio>
<audio id="sfxWin"    src="audio/super_mario_vittoria.mp3" preload="auto"></audio>

  <!-- Dati esterni + motore -->
  <script src="js/pairs.js"></script>
<script>
  // âœ… Applica filtri passati da pairs_select.html (querystring) PRIMA di avviare il motore
  (function applyPairsFiltersFromURL(){
    const params = new URLSearchParams(location.search);

    const classe = params.get("classe") || "";
    const disciplina = params.get("disciplina") || "";
    const livello = params.get("livello") || "";
    const argomento = params.get("argomento") || "";
    const numeroRaw = params.get("numero") || "";
    const numero = numeroRaw ? parseInt(numeroRaw, 10) : 0;


const seedRaw = params.get("seed") || "";
const seed = seedRaw ? parseInt(seedRaw, 10) : Date.now();

// PRNG deterministico (Mulberry32) per "ripescare" cambiando seed
function mulberry32(a){
  return function(){
    let t = a += 0x6D2B79F5;
    t = Math.imul(t ^ (t >>> 15), t | 1);
    t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
    return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
  };
}
const rand = mulberry32(Number.isFinite(seed) ? seed : Date.now());

    const src = Array.isArray(window.PAIRS) ? window.PAIRS : [];
    const getMeta = (p) => (p && p.meta) ? p.meta : {};

    // 1) filtro meta (classe/disciplina/livello) + TOPICS (argomento/argomentoSecondario)
    // Supporta:
    // - ?argomento=Frazioni (compatibilitÃ )
    // - ?topics=Frazioni&topics=Divisioni
    // - ?topics=Frazioni,Divisioni
    const norm = (s) => (s ?? "").toString().trim().toLowerCase();
    const splitTopics = (s) => norm(s).split(/\s*[,;|]+\s*/).filter(Boolean);

    // topics dalla query
    let topics = [];
    const tAll = params.getAll("topics").filter(Boolean);
    if(tAll.length){
      for(const t of tAll){
        topics.push(...splitTopics(t));
      }
    }
    // fallback a argomento=
    if(!topics.length && argomento){
      topics = splitTopics(argomento);
    }
    // dedup
    topics = Array.from(new Set(topics));

    const debug = { requested: topics.slice(), primary: [], secondary: [], both: [] };

    let filtered = src.filter(p => {
      const m = getMeta(p);

      if(classe && (m.classe || "") !== classe) return false;
      if(disciplina && (m.disciplina || "") !== disciplina) return false;
      if(livello && (m.livello || "") !== livello) return false;

      if(!topics.length) return true;

      const a1 = norm(m.argomento);
      const a2list = Array.isArray(m.argomentoSecondario)
        ? m.argomentoSecondario.map(norm).filter(Boolean)
        : splitTopics(m.argomentoSecondario);

      const hitPrimary = !!a1 && topics.includes(a1);
      const hitSecondary = a2list.some(x => topics.includes(x));

      if(hitPrimary && hitSecondary) debug.both.push(p.id || "");
      else if(hitPrimary) debug.primary.push(p.id || "");
      else if(hitSecondary) debug.secondary.push(p.id || "");

      return (hitPrimary || hitSecondary);
    });

    // Debug a video (solo quando c'Ã¨ un topic richiesto)
    (function renderTopicDebug(){
      if(!topics.length) return;
      let box = document.getElementById("topicDebug");
      if(!box){
        box = document.createElement("div");
        box.id = "topicDebug";
        box.style.marginTop = "10px";
        box.style.padding = "10px 12px";
        box.style.border = "1px dashed rgba(15,23,42,.22)";
        box.style.borderRadius = "14px";
        box.style.background = "rgba(15,23,42,.02)";
        box.style.fontSize = "13px";
        box.style.color = "#0f172a";
        const topEl = document.querySelector(".top > div");
        if(topEl) topEl.appendChild(box);
      }

    /*  const fmt = (arr) => arr.filter(Boolean).join(", ") || "â€”";
      box.innerHTML = `
        <div style="font-weight:900; margin-bottom:6px;">DEBUG TOPIC</div>
        <div><b>Richiesto:</b> ${topics.map(t=>t).join(", ")}</div>
        <div style="margin-top:6px;"><b>Match per ARGOMENTO:</b> ${fmt(debug.primary)}</div>
        <div><b>Match per ARG. SECONDARIO:</b> ${fmt(debug.secondary)}</div>
        <div><b>Match per ENTRAMBI:</b> ${fmt(debug.both)}</div>
        <div style="margin-top:6px; color:#6b7280;">Totale caricati: <b>${filtered.length}</b></div>
      `;*/
    })();
// 2) se richiesto numero, estraggo N coppie (shuffle stabile)
    if(Number.isFinite(numero) && numero > 0 && filtered.length > numero){
      // shuffle copia
      filtered = filtered
        .map(p => ({p, r: rand()}))
        .sort((a,b)=>a.r-b.r)
        .slice(0, numero)
        .map(x=>x.p);
    }

    // 3) rimpiazza PAIRS usato dal motore
    window.PAIRS = filtered;

    // debug/info (utile per status)
    window.__PAIRS_FILTER_INFO = { classe, disciplina, livello, argomento, topics: (typeof topics!=='undefined'?topics.slice():[]), numero: numero || "" };
  })();
</script>
<script src="js/pairs_engine.js"></script>
  <script>
    MatchPairs.boot();

    
    /* =====================================================
   MOBILE: solo 3 pezzi visibili alla volta
   (MAI nascondere quelli giÃ  assegnati a destra)
   ===================================================== */
(function(){
  if(window.innerWidth > 900) return;

  const left = document.getElementById("leftCol");
  const right = document.getElementById("rightCol");
  if(!left || !right) return;

  const visibleCount = 3;

  function updateVisible(){
    const pool = Array.from(left.querySelectorAll(".piece")); // âœ… SOLO quelli ancora nel box sinistro
    pool.forEach((p, i) => {
      p.style.display = (i < visibleCount) ? "" : "none";
    });
  }

  // Aggiorna subito e dopo boot
  updateVisible();
  setTimeout(updateVisible, 50);

  // Ogni volta che cambia qualcosa a destra (drop riuscito), aggiorna la â€œfilaâ€
  const obs = new MutationObserver(() => updateVisible());
  obs.observe(right, { childList:true, subtree:true });

  // E anche quando cambia il box sinistro (es. reset/mescola)
  const obs2 = new MutationObserver(() => updateVisible());
  obs2.observe(left, { childList:true, subtree:true });

})();



    // âœ… Layout: se ci sono 12 coppie, metti 3 coppie per riga (6 colonne)
    function applyRightColsByPairs(){
      const right = document.getElementById("rightCol");
      if(!right) return;
      const nDrops = right.querySelectorAll(".drop").length; // 1 drop = 1 coppia
      right.setAttribute("data-pairs", String(nDrops));
    }
    applyRightColsByPairs();


    // ðŸ” Riprendi altre: ricarica la pagina cambiando seed, mantenendo gli stessi filtri
    (function(){
      const btnRepick = document.getElementById("btnRepick");
      const btnBack = document.getElementById("btnBackSelect");

      function currentParams(){
        const p = new URLSearchParams(location.search);
        // tolgo eventuali parametri "di gioco" e imposto un nuovo seed
        p.set("seed", String(Date.now()));
        return p;
      }

      btnRepick && btnRepick.addEventListener("click", ()=>{
        const p = currentParams();
        location.href = location.pathname + "?" + p.toString();
      });

      btnBack && btnBack.addEventListener("click", ()=>{
        const p = new URLSearchParams(location.search);
        p.delete("seed");
        location.href = "pairs_select.html" + (p.toString() ? ("?" + p.toString()) : "");
      });
    })();
  
/* =====================================================
   CAMBIO NUMERO COPPIE DINAMICO
   ===================================================== */
(function(){

  const params = new URLSearchParams(location.search);
  const currentNumero = params.get("numero") || "";

  const buttons = document.querySelectorAll(".sizeBtn");

  // Evidenzia attivo
  buttons.forEach(btn=>{
    if(btn.dataset.size === currentNumero){
      btn.classList.add("active");
    }

    btn.addEventListener("click", ()=>{
      const newSize = btn.dataset.size;

      if(newSize === currentNumero) return;

      const p = new URLSearchParams(location.search);
      p.set("numero", newSize);
      p.set("seed", Date.now()); // rimescola

      location.href = location.pathname + "?" + p.toString();
    });
  });

})();



  const ZOOM_LEVELS = [0.55,0.65,0.75, 0.85, 0.95, 1.0, 1.1, 1.2, 1.3,1.4];
  const KEY = "MATCH_PAIRS_ZOOM";
  const KEY_MODE = "MATCH_PAIRS_ZMODE"; // "auto" | "manual"

  const board = document.querySelector(".wrap"); // âœ… zoom su tutto

  const label = document.getElementById("zoomLabel");
  const btnPlus = document.getElementById("zPlus");
  const btnMinus = document.getElementById("zMinus");
  const btnAuto = document.getElementById("zAuto");

  function clamp(n,a,b){ return Math.max(a, Math.min(b,n)); }
  function findNearestZoom(target){
    let best = ZOOM_LEVELS[0], bestD = Infinity;
    for(const z of ZOOM_LEVELS){
      const d = Math.abs(z - target);
      if(d < bestD){ bestD = d; best = z; }
    }
    return best;
  }

  function countPairs(){
    return document.querySelectorAll("#rightCol .drop").length || 0;
  }

  function computeAutoZoom(){
    const pairs = countPairs();
    const w = window.innerWidth;
    const h = window.innerHeight;

    let base = 1.0;
    if (w >= 1600) base = 1.05;
    if (w >= 1900) base = 1.10;

    let target = base;

    if (pairs <= 6) target = base + 0.10;
    else if (pairs <= 8) target = base + 0.05;
    else if (pairs <= 10) target = base;
    else if (pairs <= 12) target = base - 0.08;
    else target = base - 0.15;

    if (h < 820) target -= 0.07;
    if (h < 720) target -= 0.10;

    target = clamp(target, ZOOM_LEVELS[0], ZOOM_LEVELS[ZOOM_LEVELS.length-1]);
    return findNearestZoom(target);
  }

  function setMode(mode){
    localStorage.setItem(KEY_MODE, mode);
    // UI button
    if(btnAuto) btnAuto.classList.toggle("on", mode === "auto");
  }

  function applyZoom(z, mode){
    if(!board) return;
    board.style.zoom = z;
    if(label){
      label.textContent = (mode === "auto")
        ? `AUTO ${Math.round(z*100)}%`
        : `${Math.round(z*100)}%`;
    }
  }

  function setAuto(){
    setMode("auto");
    const z = computeAutoZoom();
    applyZoom(z, "auto");
  }

  function getManual(){
    const v = parseFloat(localStorage.getItem(KEY) || "1");
    return findNearestZoom(Number.isFinite(v) ? v : 1.0);
  }

  function setManual(z){
    setMode("manual");
    localStorage.setItem(KEY, String(z));
    applyZoom(z, "manual");
  }

  function step(dir){
    const mode = localStorage.getItem(KEY_MODE) || "auto";
    const current = (mode === "manual") ? getManual() : computeAutoZoom();
    const idx = ZOOM_LEVELS.indexOf(findNearestZoom(current));
    const next = ZOOM_LEVELS[clamp(idx + dir, 0, ZOOM_LEVELS.length-1)];
    setManual(next); // âž•/âž– = manuale
  }

  // Eventi
  btnAuto?.addEventListener("click", setAuto);
  btnPlus?.addEventListener("click", ()=>step(1));
  btnMinus?.addEventListener("click", ()=>step(-1));

  window.addEventListener("resize", () => {
    if((localStorage.getItem(KEY_MODE) || "auto") === "auto"){
      setAuto();
    }
  });

  // dopo reset/mescola ricalcolo auto se serve
  document.getElementById("btnReset")?.addEventListener("click", () => {
    if((localStorage.getItem(KEY_MODE) || "auto") === "auto"){
      setTimeout(setAuto, 60);
    }
  });
  document.getElementById("btnShuffle")?.addEventListener("click", () => {
    if((localStorage.getItem(KEY_MODE) || "auto") === "auto"){
      setTimeout(setAuto, 60);
    }
  });

  // Avvio: se manuale esiste, lo applico; altrimenti auto
  (function init(){
    const mode = localStorage.getItem(KEY_MODE) || "auto";
    if(mode === "manual"){
      setMode("manual");
      applyZoom(getManual(), "manual");
    } else {
      setAuto();
    }
  })();
</script>




<script>
/* Blocca menu "salva immagine" su LIM + dragstart nativo su PC */
document.addEventListener("contextmenu", (e)=>{
  if(e.target.closest(".piece")) e.preventDefault();
}, {passive:false});

document.addEventListener("dragstart", (e)=>{
  if(e.target.closest(".piece")) e.preventDefault();
}, {passive:false});
</script>


</body>
</html>
